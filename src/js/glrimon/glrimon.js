// Generated by CoffeeScript 1.6.1
var layer_url, map;

map = {};

layer_url = "http://umd-cla-gis01.d.umn.edu:6080/arcgis/rest/services/NRRI/glritest000/MapServer";

require(["esri/map", "esri/layers/FeatureLayer", "esri/dijit/AttributeInspector", "esri/symbols/SimpleLineSymbol", "esri/symbols/SimpleFillSymbol", "dojo/_base/Color", "esri/layers/ArcGISDynamicMapServiceLayer", "esri/config", "esri/tasks/query", "dojo/parser", "dojo/dom-construct", "dijit/form/Button", "dijit/layout/BorderContainer", "dijit/layout/ContentPane", "dojo/domReady!"], function(Map, FeatureLayer, AttributeInspector, SimpleLineSymbol, SimpleFillSymbol, Color, ArcGISDynamicMapServiceLayer, esriConfig, Query, parser, domConstruct, Button) {
  var attInspector, layer, legendDijit;
  esriConfig.defaults.io.proxyUrl = "/proxy";
  map = new Map('mapDiv', {
    basemap: "topo",
    center: [-88, 44],
    zoom: 7
  });
  map.on("layers-add-result", function(evt) {
    var layer, layerInfos, selectQuery;
    console.log("layers-add-result");
    layer = evt.layers[0].layer;
    selectQuery = new Query();
    return layerInfos = [
      {
        'featureLayer': layer,
        'showAttachments': false,
        'isEditable': true,
        'fieldInfos': [
          {
            'fieldName': 'activeprod',
            'isEditable': true,
            'tooltip': 'Current Status',
            'label': 'Status:'
          }, {
            'fieldName': 'field_name',
            'isEditable': true,
            'tooltip': 'The name of this oil field',
            'label': 'Field Name:'
          }, {
            'fieldName': 'approxacre',
            'isEditable': false,
            'label': 'Acreage:'
          }, {
            'fieldName': 'avgdepth',
            'isEditable': false,
            'label': 'Average Depth:'
          }, {
            'fieldName': 'cumm_oil',
            'isEditable': false,
            'label': 'Cummulative Oil:'
          }, {
            'fieldName': 'cumm_gas',
            'isEditable': false,
            'label': 'Cummulative Gas:'
          }
        ]
      }
    ];
  });
  if (layerInfo.length > 0) {
    console.log(layerInfo);
    legendDijit = new Legend({
      map: map,
      layerInfos: [](layerInfo)
    }, "legendDiv");
  }
  legendDijit.startup();
  attInspector = new AttributeInspector({
    layerInfos: layerInfos
  }, domConstruct.create("div"));
  map.infoWindow.setContent(attInspector.domNode);
  layer = new ArcGISDynamicMapServiceLayer(layer_url);
  return map.addLayers([layer]);
});
